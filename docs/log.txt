top - 19:18:55 up 174 days,  4:44,  5 users,  load average: 347.52, 319.94, 214.49
Tasks: 973 total,  88 running, 885 sleeping,   0 stopped,   0 zombie
%Cpu(s):  2.5 us, 96.4 sy,  0.0 ni,  0.0 id,  0.1 wa,  0.5 hi,  0.5 si,  0.0 st
MiB Mem :  63879.9 total,    291.8 free,  40428.0 used,  23160.1 buff/cache
MiB Swap:      0.0 total,      0.0 free,      0.0 used.    602.9 avail Mem

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
2841339 root      20   0   24.0g   2.2g      0 S 289.6   3.5  14:45.21 java
2845696 root      20   0 9888.9m 324180      0 S 211.4   0.5   5:06.28 java
   8529 systemd+  20   0 2777360 442404      0 S 201.9   0.7   1401:11 mysqld
2281669 root      20   0   36.4g   1.3g      0 S 193.6   2.1 141:23.20 java
2818059 root      20   0   23.3g   3.4g      0 S 193.6   5.5  14:45.18 java
2845650 root      20   0   17.9g 641636      0 S 193.4   1.0  10:54.83 java
   8658 root      20   0 3099944   1.5g      0 S 192.6   2.4 540:29.84 java
2847213 root      20   0 9843680 354452      0 S 192.6   0.5   8:26.47 java
   2267 root      20   0 8669496  77480      0 S 183.5   0.1  11141:28 dockerd
  11452 root      20   0   21.7g 874224      0 S 176.6   1.3   1280:55 java
2280634 101       20   0   22.3g 397452      0 S 175.3   0.6 215:59.06 java
2846834 root      20   0   18.0g 406956      0 S 174.5   0.6  11:30.94 java
   9442 systemd+  20   0 5249136   1.4g      0 S 169.1   2.2   1260:39 mysqld
   8807 root      20   0   23.7g 774232      0 S 167.6   1.2 442:54.27 java
   8177 systemd+  20   0 6785668 863708      0 S 166.2   1.3 822:52.33 mysqld
2846345 root      20   0   17.9g 380324      0 S 163.6   0.6  10:26.96 java
2280590 systemd+  20   0 1902704 216708      0 S 143.1   0.3  32:45.95 mysqld
2847705 root      20   0   18.0g 418312      0 S 140.4   0.6   6:36.14 java
2321321 systemd+  20   0 3206796 350912      0 S 135.9   0.5  53:36.58 mysqld
   9240 root      20   0 3812416   1.9g      0 S 129.8   3.0   2982:30 java
2513377 7474      20   0   31.5g   3.7g      0 S 117.6   5.9 129:08.80 java
    295 root      20   0       0      0      0 R 100.0   0.0 158:01.11 kswapd0
  28046 root      20   0 3286364 432460      0 S 113.6   0.7   2377:52 java
2281544 root      20   0   13.3g 277088      0 S 111.4   0.4  66:17.63 java
2510086 root      20   0   25.9g   2.5g      0 S 109.0   3.9  43:47.96 java
2846711 root      20   0   17.9g 375452      0 S  95.2   0.6  10:34.50 java
2852309 root      20   0 1596792  24952      0 S  86.4   0.0   0:59.82 docker
   8895 root      20   0   23.0g   1.9g      0 S  84.8   3.0 355:32.02 java
2853313 root      20   0   34048    144      0 D  79.3   0.0   0:10.54 systemd-cgroups
  51303 tieta     20   0 8174196 193852   6928 R  76.1   0.3 703:24.56 gnome-shell
2848320 root      20   0   18.2g 613316      0 S  72.9   0.9   7:22.32 java
   3402 gdm       20   0 8016600 165268   5148 D  72.6   0.3 992:57.48 gnome-shell
2513272 root      20   0  107700   1028      0 S  66.8   0.0   2:43.93 containerd-shim
2853320 root      20   0   29556   4472      0 R  66.0   0.0   0:04.89 ksmtuned
 996416 root      20   0  109108    980      0 S  59.3   0.0   9:14.41 containerd-shim
2835966 bj        20   0  161192   1324      0 S  59.0   0.0   0:17.65 sshd
   7953 systemd+  20   0   40708   1828      0 D  58.8   0.0 294:43.73 redis-server
2852699 root      20   0 8141888 191864      0 S  56.9   0.3   4:23.70 java
2280596 root      20   0   94328   2836      0 R  55.6   0.0  31:38.41 redis-server

top - 19:18:55 up 174 days,  4:44,  5 users,  load average: 347.52, 319.94, 214.49
Tasks: 973 total,  88 running, 885 sleeping,   0 stopped,   0 zombie
%Cpu(s):  2.5 us, 96.4 sy,  0.0 ni,  0.0 id,  0.1 wa,  0.5 hi,  0.5 si,  0.0 st
MiB Mem :  63879.9 total,    291.8 free,  40428.0 used,  23160.1 buff/cache
MiB Swap:      0.0 total,      0.0 free,      0.0 used.    602.9 avail Mem

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
2841339 root      20   0   24.1g   2.2g      0 S 207.4   3.5  29:22.55 java
2818059 root      20   0   23.3g   3.4g      0 S 189.9   5.5  25:25.70 java
   2267 root      20   0 8669496  77536      0 S 185.6   0.1  11154:34 dockerd
2281544 root      20   0   13.3g 276796      0 S 168.1   0.4  74:54.01 java
2280634 101       20   0   22.3g 397512      0 S 163.5   0.6 226:14.57 java
2846834 root      20   0   18.0g 407316      0 S 153.4   0.6  19:04.31 java
2281669 root      20   0   36.4g   1.3g      0 S 150.6   2.1 150:18.68 java
2852408 root      20   0   10.8g 863288      0 S 150.3   1.3  24:00.97 java
   8529 systemd+  20   0 2777360 442420      0 S 142.3   0.7   1410:06 mysqld
2846345 root      20   0   17.9g 380660      0 S 139.9   0.6  17:28.54 java
   8177 systemd+  20   0 6785668 863676      0 S 138.0   1.3 828:44.88 mysqld
   8658 root      20   0 3099944   1.5g      0 S 137.4   2.4 545:29.43 java
2513377 7474      20   0   31.5g   3.7g      0 S 128.8   5.9 136:21.58 java
2845650 root      20   0   17.9g 643824      0 S 123.3   1.0  19:15.60 java
  11452 root      20   0   21.7g 874224      0 S 119.9   1.3   1290:05 java
2847213 root      20   0 9843680 355232      0 S 117.5   0.5  16:47.28 java
  28046 root      20   0 3296624 433964      0 S 115.6   0.7   2386:21 java
    295 root      20   0       0      0      0 R 100.0   0.0 165:06.43 kswapd0
   9442 systemd+  20   0 5249136   1.4g      0 S 101.8   2.2   1268:46 mysqld
2510086 root      20   0   25.9g   2.5g      0 S 101.2   3.9  48:52.78 java
   8807 root      20   0   23.7g 774236      0 S 100.6   1.2 451:28.78 java
2846711 root      20   0   17.9g 375812      0 S 100.3   0.6  16:45.74 java
2280590 systemd+  20   0 1902704 216752      0 S  94.5   0.3  39:58.92 mysqld
   8895 root      20   0   23.0g   1.9g      0 S  93.9   3.0 362:37.83 java
2321321 systemd+  20   0 3206796 350912      0 S  88.3   0.5  59:24.33 mysqld
   3402 gdm       20   0 8016600 165280   5148 D  87.4   0.3 996:20.90 gnome-shell
2853452 root      20   0  103728   1240    376 D  65.6   0.0   0:31.64 sudo
  51303 tieta     20   0 8174196 193864   6928 D  60.7   0.3 706:47.08 gnome-shell
2280596 root      20   0   94328   2836      0 D  58.3   0.0  34:18.59 redis-server
   7953 systemd+  20   0   40708   1828      0 R  55.5   0.0 297:25.95 redis-server
2852699 root      20   0 8141888 191924      0 S  47.5   0.3   7:03.04 java
   9240 root      20   0 3813444   1.9g      0 S  44.5   3.0   2985:13 java
2847705 root      20   0   18.0g 418688      0 S  41.4   0.6  12:31.62 java
2848320 root      20   0   18.2g 632168      0 S  33.1   1.0  13:08.04 java
2280548 root      20   0  107700    796      0 S  32.5   0.0   1:56.58 containerd-shim
   8369 systemd+  20   0 2046980 468368      0 S  25.5   0.7 270:57.97 mysqld
2281029 root      20   0  107700   1020      0 S  23.9   0.0   1:50.65 containerd-shim
2848107 root      20   0   18.0g 399100      0 S  21.5   0.6   6:27.22 java
2853495 root      20   0   29556   4472      0 S  21.5   0.0   0:00.70 ksmtuned

docker exec -it master spark-shell --executor-memory 512M --total-executor-cores 2
2022-01-11 16:21:25 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Spark context Web UI available at http://localhost:4040
Spark context available as 'sc' (master = spark://master:7077, app id = app-20220111162129-0002).
Spark session available as 'spark'.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.3.0
      /_/

Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_131)
Type in expressions to have them evaluated.
Type :help for more information.

scala>